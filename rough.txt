sales_df = 'Billing Document No.', 'Ship-to Party', 'Sales Order No',
       'Sold-to Party', 'Sold-to-Party Name', 'Material',
       'Material Description', 'Material Group', 'Plant',
       'Plant Description', 'Plant Reg State', 'Net Value of Billing item',
       'Quantity', 'Fiscal Year','Sold-to Group'

mou_df = 'Sold-to Party', 'Sold-to-Party Name','MOU Start Date','MOU End Date','PP','PE'

group_df = 'Sold-to Party', 'Sold-to-Party Name','Sold-to Group'

filtered_df = 'Billing Document No.', 'Billing Date', 'Ship-to Party', 'Sold-to Party', 
'Sold-to-Party Name', 'Material', 'Material Description', 'Material Group', 'Plant', 
'Plant Description', 'Plant Reg State', 'Net Value of Billing item', 'Quantity', 
'Fiscal Year', 'Year', 'Month', 'Regional Office', 'Sold-to Group'

To Do
1. Start Pages
2. Dashboard Graphs

# X-Y Scheme
    elif discount_option == "X-Y Scheme":
            st.subheader("X-Y Scheme")
            col1, col2 = st.columns(2)
            with col1:
                start_date = st.date_input("Discount Start Date")
            with col2:
                end_date = st.date_input("Discount End Date")
            with col1:
                x_scheme_value = st.number_input("Enter X-Scheme Amount")
            with col1:
                y_scheme_value = st.number_input("Enter MOU Annual Component")
            
            discount_amount = max(x_scheme_value,y_scheme_value)
            data_to_save = {
                "material_groups": material_group,
                "discount_type": discount_option,
                "start_date": start_date.isoformat() if isinstance(start_date, datetime.date) else None,
                "end_date": end_date.isoformat() if isinstance(end_date, datetime.date) else None,
                "monthly_component": month_mou_value,
                "annual_component": annual_mou_value,
                "discount_amount": discount_amount
            }

elif basis== "Flat Discount":
                    base_mask = (
                    df["Material Group"].isin(material_groups) &
                    (df["Billing Date"] >= disc_start) &
                    (df["Billing Date"] <= disc_end)
                )
                     # --- GROUP-LEVEL TOTAL QUANTITY ---
                    qty_group = (
                        df.loc[base_mask]
                        .groupby("Sold-to Group", as_index=False)["Quantity"]
                        .sum()
                    )
                    
                    # --- SLAB RESOLUTION ---
                    qty_group["Hidden Discount"] = qty_group["Quantity"].apply(
                        lambda x: discount.get_slab_amount(x, slabs)
                    )
                    
                    hidden_map = (
                        qty_group
                        .set_index("Sold-to Group")["Hidden Discount"]
                        .to_dict()
                    )
                    
                    assign_mask = base_mask & df["Material Group"].isin(valid_materials)
                    st.write("Rows eligible:", assign_mask.sum())
                    st.write(
                        df.loc[assign_mask, ["Sold-to Group", "Material Group"]]
                        .drop_duplicates()
                    )
                    # ðŸ”‘ ACCUMULATE instead of overwrite
                    df.loc[assign_mask, "Hidden Discount"] += (
                        df.loc[assign_mask, "Sold-to Group"]
                        .map(hidden_map)
                        .fillna(0.0)
                    )